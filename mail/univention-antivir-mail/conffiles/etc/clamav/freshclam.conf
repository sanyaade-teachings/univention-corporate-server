@%@UCRWARNING=# @%@

DatabaseOwner clamav
UpdateLogFile /var/log/clamav/freshclam.log
LogFileMaxSize 0
MaxAttempts 5
# Check for new database 24 times a day
Checks @%@clamav/checks@%@
@!@
from urllib.parse import urlparse
if configRegistry.get('clamav/database/mirror'):
	for mirror in configRegistry['clamav/database/mirror'].split(' '):
		print('DatabaseMirror %s' % mirror)

# ClamAV proxy
if configRegistry.get('clamav/proxy/http'):
	print('HTTPProxyServer %s' % configRegistry['clamav/proxy/http'])
	if configRegistry.get('clamav/proxy/username'):
		print('HTTPProxyUsername %s' % configRegistry['clamav/proxy/username'])
	if configRegistry.get('clamav/proxy/password'):
		print('HTTPProxyPassword %s' % configRegistry['clamav/proxy/password'])
	if configRegistry.get('clamav/proxy/port'):
		print('HTTPProxyPort %s' % configRegistry['clamav/proxy/port'])
# global proxy
elif configRegistry.get('proxy/http'):
	u = urlparse(configRegistry['proxy/http'])
	print('HTTPProxyServer %s' % u.hostname)
	if u.username:
		print("HTTPProxyUsername %s" % u.username)
	if u.password:
		print("HTTPProxyPassword %s" % u.password)
	if u.port:
		print('HTTPProxyPort %s' % u.port)
# no proxy

@!@
DatabaseDirectory /var/lib/clamav/
NotifyClamd /etc/clamav/clamd.conf
DNSDatabaseInfo current.cvd.clamav.net
PidFile /var/run/clamav/freshclam.pid
