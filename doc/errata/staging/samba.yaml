product: ucs
release: "5.0"
version: [3]
scope: ucs_5.0-0-errata5.0-3
src: samba
fix: 2:4.16.8-1A~5.0.0.202307171204
desc: |
 This update addresses the following issues:
 * When winbind is used for NTLM authentication, a maliciously
   crafted request can trigger an out-of-bounds read in winbind
   and possibly crash it (CVE-2022-2127).
 * An infinite loop bug in Samba's mdssvc RPC service for Spotlight
   can be triggered by an unauthenticated attacker by issuing a
   malformed RPC request (CVE-2023-34966).
 * Missing type validation in Samba's mdssvc RPC service for Spotlight
   can be used by an unauthenticated attacker to trigger a process crash
   in a shared RPC mdssvc worker process (CVE-2023-34967).
 * As part of the Spotlight protocol Samba discloses the server-side
   absolute path of shares and files and directories in search results
   (CVE-2023-34968).
 * A followup patch for CVE-2022-38023, which Samba included in 4.16.9
   has been applied: Samba should refuse RC4 (aka md5) based SChannel on
   netlogon.
 * After Microsoft released the July 2023 updates, Windows clients showed
   login errors. Samba has been adjusted to handle the new behavior of
   netlogon secure channel negotiation.
bug: [56300, 56321]
cve:
 - CVE-2022-2127
 - CVE-2022-38023
 - CVE-2023-34966
 - CVE-2023-34967
 - CVE-2023-34968
