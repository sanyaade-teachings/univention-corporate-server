#!/usr/share/ucs-test/runner bash
# shellcheck shell=bash
## desc: Checking ldap schema download
## tags: [basic]
## roles:
##  - domaincontroller_master
## packages:
##  - univention-config
##  - univention-directory-manager-tools
## exposure: careful

# shellcheck source=../../lib/ucr.sh
. "$TESTLIBPATH/ucr.sh" || exit 137
# shellcheck source=../../lib/undo.sh
. "$TESTLIBPATH/undo.sh" || exit 137

# activate ldap schema download
ucr set ldap/schema/export=yes
undo /etc/init.d/slapd restart
undo ucr_restore
/etc/init.d/slapd restart

# try to download schema file
wget -c "$(hostname)/ldap-schema.txt" -O /dev/null
